-- 계정명 : test01
-- 비밀번호 : 1234
-- 권한 create session, create table, create view, resource

-- 계정 만들고 a1~a4 테이블 등록 후 문제 풀기
SELECT * FROM JOBS ;
SELECT * FROM EMPLOYEES e ;
/* 1. JOBS 테이블에서 JOB_ID로 직원들의 JOB_TITLE, EMAIL, 성, 이름 조회 */


SELECT J.JOB_TITLE, EMAIL, LAST_NAME, FIRST_NAME
FROM JOBS J
JOIN(SELECT EMAIL, LAST_NAME, FIRST_NAME
	FROM EMPLOYEES)
	ON J.JOB_ID = JOB_ID;


/* 2. EMPLOYEES 테이블에서 HIREDATE가 2003~2004년까지인 사원의 정보와 부서명 검색 */
	SELECT * FROM EMPLOYEES e ;

	SELECT EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, DEPARTMENT_ID
	FROM EMPLOYEES e 
	WHERE HIRE_DATE BETWEEN '2003-01-01' AND '2004-12-31';


/* 3. EMP 테이블에서 ENAME에 L이 있는 사원들의 DNAME과 LOC 검색 */
SELECT * FROM emp;
SELECT * FROM dept;

SELECT DNAME, LOC, ENAME
FROM DEPT D
JOIN (SELECT ENAME FROM EMP WHERE ENAME LIKE '%L%')
	ON D.DEPTNO = DEPTNO;



/* 4. SCHEDULE 테이블에서 경기 일정이 20120501 ~ 20120502 사이에 있는 경기장 전체 정보 조회 */
SELECT *FROM SCHEDULE s;

SELECT * FROM SCHEDULE s 
WHERE SCHE_DATE IN ('20120501', '20120502');

-- 바깥 쿼리						안쪽 쿼리
/* 5. 축구 선수들 중에서 각 팀 별로/ 키가 가장 큰 선수들의 전체 정보 조회 */
/* 위 문제를 JOIN없이 풀기
 * (A,B) IN (C, D) : A = C AND B = D */
SELECT * FROM PLAYER;

SELECT PLAYER_ID
FROM PLAYER p 
--WHERE HEIGHT (A,B) IN (C,D) : A = C AND B = D;



/* 6. EMP 테이블의 SAL을 이용, SALGRAED 테이블을 참고하여 모든 사원의 정보를 GRADE를 포함하여 조회 */
SELECT * FROM EMP;
SELECT * FROM SALGRADE;

SELECT E.*, S.GRADE
FROM EMP E
FULL OUTER JOIN SALGRADE s
ON E.DEPTNO = DEPTNO;

/* 7. EMP 테이블에서 각 사원의 매니저 이름 조회 */
SELECT * FROM EMP;

SELECT ENAME, DEPTNO 
FROM EMP e 
WHERE DEPTNO IN (SELECT DEPTNO FROM EMP);

/* 8. 축구 선수들 중에서 각 팀 별로 키가 가장 큰 선수들의 전체 정보 조회 */

SELECT PLAYER_ID
FROM PLAYER P 
JOIN (SELECT TEAM_ID, MAX(HEIGHT
FROM PLAYER P2 
GROUP BY TEAM_ID)
ON P.TEAM_ID = P2.TEAM_ID;
	
